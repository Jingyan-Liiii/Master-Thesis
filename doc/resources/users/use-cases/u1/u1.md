# The Magic of Genericity {#u1}
> **The guide for this use-case is still in development and may be incomplete. Please excuse any inconveniences.**

[TOC]

# The Magic of Genericity
> In this use case, we make GCG do the task it has been made for: **solving structured mixed-integer programs**.
> We will **not go into any details** concerning decomposition, reformulation or
> branch-and-price-and-cut, but only elaborate a use case where one can solve
> a problem without any previous knowledge except about their problem.


## Introduction
<img src="1.png" style="float: left; padding: 0 10px 0 0; width: 10%">
**This is Andrew.** He lives near Edinburgh and has just founded his Start-up "Edin-OR" which 
specializes on optimizing planning and decision making processes within companies.
Luckily, he has a friend over at _Royal Mail_, the local postal services company, 
who might help him with getting his first real job, **scheduling the vehicles** that deliver the mail.
Since the management is doubtful of Andrew's capacilities, they ask him to begin with
artificial data that is, however, very close to theirs. As a start, they suggest instances first used by
Christofides et al. \cite u1:christofides1981exact.\n
As always, Andrew starts with the exact problem definition.


## Problem Definition
### The Vehicle Routing Problem
TODO: insert texed "text-book" VRP program (cited!)
\f{align}{
  & \text{min}
  & & \sum_{i\in V}x_i \\
  & \text{s.t.} & & \sum_{j\in N(i)} y_{ji} \geq 1 - x_i && i\in V \tag{BP} \\
  & & & \sum_{j\in N(i)} y_{ij} \leq u_i x_i && i\in V \\
  & & & x_i\in\{0,1\} && i\in V \\
  \f}

The data and model are then given by one of the instances of Christofides et al. Andrew tries to choose an instance
of medium difficulty to start with, even though they might become much bigger once he gets real data. The instance
is called `E021-06m` (N=21, M=6, Q=4000).

## Solving
With the problem at hand, Andrew starts searching for solvers of mixed integer programs. He quickly comes
across the most common ones like Gurobi and SCIP. The latter has the advantage, that it is source-open and can
be used **without having to purchase a license**, which is a big advantage because Andrew just wants do to a bit of
testing and furthermore does not have that much capital yet. Thus, he tries to solve his instance with SCIP. 
It does take some time, but for this medium sized instance, he gets results after about 20 minutes. (TODO: at least..) 
He thinks that he could do better, since Andrew knows that the problem at hand is a ***structured* integer program**.
Thus, he starts searching for state-of-the-art methods for solving those. He encounters **many proprietary approaches**, 
where scientists had implemented their own customized solvers for their own vehicle routing and many other problems, 
but since Andrew has not yet gotten the hang of all this "decomposing", "pricing" or "cutting"
and he also wants to **reuse code as efficiently and often as possible**, he starts looking
for _generic_ solvers **that would do all of that automatically for him** and finally finds "Generic Column Generation",
which seems to be fitting. He is happy about the interface of GCG being just like those of all other commonly used
solvers, but since the search for existing approaches had taken him so long, there is not much time left to solve 
the vehicle routing problem the management gave him, so he just goes ahead and compiles and **fires up GCG** with a simple

```
./bin/gcg
```
The output he is getting shows him the software versions and some copyright information.
If he were to add more external code, which could improve solving speed, they would appear under "External Codes".
As LP solver, he again can rely on the source-open solver "SoPlex", which, in contrast to "CPLEX" did not cost him
anything. It is part of the whole SCIP Optimization Suite. Finally, he can see that the default settings are being used,
which is fine, since he will not do any fine-tuning.\n

```
GCG version 3.1.0 [GitHash: 90d8bdf3]
Copyright (C) 2010-2020 Operations Research, RWTH Aachen University
                        Konrad-Zuse-Zentrum fuer Informationstechnik Berlin (ZIB)

SCIP version 7.0.0 [precision: 8 byte] [memory: block] [mode: optimized] [LP solver: SoPlex 5.0.0] [GitHash: 0bc4dc9c6]
Copyright (C) 2002-2020 Konrad-Zuse-Zentrum fuer Informationstechnik Berlin (ZIB)

External codes: 
  Readline 8.0         GNU library for command line editing (gnu.org/s/readline)
  SoPlex 5.0.0         Linear Programming Solver developed at Zuse Institute Berlin (soplex.zib.de) [GitHash: 6535a3c8]
  CppAD 20180000.0     Algorithmic Differentiation of C++ algorithms developed by B. Bell (www.coin-or.org/CppAD)
  ZLIB 1.2.11          General purpose compression library by J. Gailly and M. Adler (zlib.net)

user parameter file <gcg.set> not found - using default parameters
```
To continue, Andrew now wants to **read in his problem**. This can be done with a simple `read` and then the problem file.
GCG will signalize that the problem was read successfully and already give some statistics: `E021-06m` only contains a
few continuous variables and quite some integer variables and 2600 inequalities that are constraining the problem.
```
GCG> read E021-06m.cvrp.lp.gz 

read problem <E021-06m.cvrp.lp.gz>
============

original problem has 2766 variables (0 bin, 2646 int, 0 impl, 120 cont) and 2600 constraints
```
Finally, after looking at the @ref getting-started Guide in GCG's documentation, he proceeds with **optimizing his problem**.
```
GCG> optimize

Presolving Time: 0.75
Detection Time: 0.24

A Dantzig-Wolfe reformulation is applied to solve the original problem.
Chosen structure has 6 blocks and 20 linking constraints.
This decomposition has a maxwhite score of 0.826893.
Warning: Discretization with continuous variables is only an experimental feature.
Master problem is a set partitioning problem.
Matrix has 6 blocks, using 1 aggregated pricing problem.

  time | node  | left  |SLP iter|MLP iter|LP it/n| mem |mdpt |ovars|mvars|ocons|mcons|mcuts|  dualbound   | primalbound  |  deg   |  gap   
p  0.9s|     1 |     0 |      0 |      0 |     - |  23M|   0 |2682 |   0 |2588 |   0 |   0 | 0.000000e+00 | 6.217321e+02 |   --   |    Inf 
   1.0s|     1 |     0 |      0 |      0 |     - |  23M|   0 |2682 |   0 |2588 |   0 |   0 | 3.242201e+02 | 6.217321e+02 |   --   |  91.76%

     
   1.0s|     1 |     0 |      0 |      0 |     - |  23M|   0 |2682 |   6 |2589 |  22 |   0 | 3.242201e+02 | 6.217321e+02 |   0.00%|  91.76%
   1.0s|     1 |     0 |      0 |      0 |     - |  23M|   0 |2682 |   6 |2589 |  22 |   0 | 3.242201e+02 | 6.217321e+02 |   0.00%|  91.76%
Starting reduced cost pricing...
*r14.2s|     1 |     0 |  19718 |    145 |     - |  25M|   0 |2682 | 118 |2589 |  22 |   0 | 3.761693e+02 | 4.308847e+02 |  37.05%|  14.55%
  14.2s|     1 |     0 |  19718 |    145 |     - |  25M|   0 |2682 | 118 |2589 |  22 |   0 | 3.761693e+02 | 4.308847e+02 |  37.05%|  14.55%
  39.1s|     1 |     0 |  90613 |    174 |     - |  25M|   0 |2682 | 146 |2589 |  22 |   0 | 4.308847e+02 | 4.308847e+02 |  45.44%|   0.00%
  39.1s|     1 |     0 |  90613 |    174 |     - |  25M|   0 |2682 | 118 |2589 |  22 |   0 | 4.308847e+02 | 4.308847e+02 |   --   |   0.00%

SCIP Status        : problem is solved [optimal solution found]
Solving Time (sec) : 39.13
Solving Nodes      : 1
Primal Bound       : +4.30884678000000e+02 (2 solutions)
Dual Bound         : +4.30884678000000e+02
Gap                : 0.00 %
```

## WIP below this point
@todo explain output

GOALS OF THIS GUIDE  
Format Requirements
- Create an **appealing persona** for a first impression of GCG 
- Offer content that is quite similar to the Getting Started, but with a **personal touch and a tangible example**
- Follow the first steps of the **OR analytics process** without technical detail
- Link to second guide for problem file generation and theory explanations

Content Requirements (takeaways)  
- GCG can be (much) **faster** than other non-commercial solvers
- GCG is so **easy** to (install? and) use, even with no knowledge on the field whatsoever
  - do not show how to create an instance file (e.g. with ZIMPL), that is subject of the second use case
- GCG makes **taylored solutions obsolete** through being generically applicable to all types of problems ("no search needed anymore!")
- GCG is **free for everyone** and source-open, no paying for software like gurobi or CPLEX required 

Content Requirements (explanations)
- general workflow for solving MIP problems
- starting and solving with GCG
- the different components of the log
  - do not explain theory (e.g. DWR), that is subject of the second use case
- how variable values can be read and common expressions (e.g. `y#1#2` = \f[y_{12} \f])
- ...